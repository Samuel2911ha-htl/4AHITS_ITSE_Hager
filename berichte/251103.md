# 4AHITS ITSE G1 (03.11.2025) Port Scan
---

- Klasse: 4AHITS
- Name: Samuel Hager
- Fach: ITSE
- Datum: 3.11.2025

## Übung (port probing)
Beim port probing möchte man herausfinden ob auf einem gewissen port ein Dienst läuft, welcher Dienst dies ist und (wenn möglich) mehr Details wie z.B. Versionsnummern. Diese Information dient als Basis für weitere Angriffe.

`telnet`, `nc` (netcat) und `curl` sind einfache Tools die zum port probing verwendet werden können. Teilweise ist es auch möglich die kontaktierten Dienste dazu zu veranlassen mehr Informationen über sich preiszugeben (banner grabbing).

- Verwende `telnet` um festzustellen ob ein ssh Server auf Metasploitable läuft
- Finde Bezeichnung und die Versionsnummer des Web Servers auf Metasploitable heraus. Auf 3 Arten:
  - Verwende `telnet`
  - Verwende `nc` (netcat)
    - Hinweis: der notwendige http request header kann am besten mit Hilfe eines Shell here-documents   beschrieben werden.
    - Verwende `curl`
- Erstelle ein port probing cheat sheet für alle 3 Tools

Den `telnet` Befehl verwendet man wie folgt:
![](berichte/Images/telnetssh.png)

Hinter die IP des Zielrechners folgt noch der Port 22, dieser steht für ssh. Wenn die Meldung dann ein `Trying` und `Connected` enthält, dann ist ssh aktiv.

Gleiches funkioniert natürlich mit einer anderen Portnummer für den Web Server. Dieser läuft auf Port 80. Zusätzlich benötigt man dann noch den kurzen Text `GET / HTTP/1.0`. Mit diesem Request Header kommuniziert man exlpiziet über HTTP und gibt die Version an.
Die Ausgabe sieht dann wie folgt aus:
```sh
┌──(kali㉿kali)-[~]
└─$ telnet 192.168.9.52 80                      
Trying 192.168.9.52...
Connected to 192.168.9.52.
Escape character is '^]'.
GET / HTTP/1.0

HTTP/1.1 200 OK
Date: Mon, 13 Oct 2025 11:50:08 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Content-Length: 891
Connection: close
Content-Type: text/html

<html><head><title>Metasploitable2 - Linux</title></head><body>
<pre>

                _                  _       _ _        _     _      ____  
 _ __ ___   ___| |_ __ _ ___ _ __ | | ___ (_) |_ __ _| |__ | | ___|___ \ 
| '_ ` _ \ / _ \ __/ _` / __| '_ \| |/ _ \| | __/ _` | '_ \| |/ _ \ __) |
| | | | | |  __/ || (_| \__ \ |_) | | (_) | | || (_| | |_) | |  __// __/ 
|_| |_| |_|\___|\__\__,_|___/ .__/|_|\___/|_|\__\__,_|_.__/|_|\___|_____|
                            |_|                                          


Warning: Never expose this VM to an untrusted network!

Contact: msfdev[at]metasploit.com

Login with msfadmin/msfadmin to get started


</pre>
<ul>
<li><a href="/twiki/">TWiki</a></li>
<li><a href="/phpMyAdmin/">phpMyAdmin</a></li>
<li><a href="/mutillidae/">Mutillidae</a></li>
<li><a href="/dvwa/">DVWA</a></li>
<li><a href="/dav/">WebDAV</a></li>
</ul>
</body>
</html>

Connection closed by foreign host.
```
Mit `netcat` muss man mit einer Pipe arbeiten um den Request Header zuerst mit einem `printf` zu übergeben.
```sh
┌──(kali㉿kali)-[~]
└─$ printf 'HEAD / HTTP/1.0\r\nHost: 192.168.9.52\r\n\r\n' | nc 192.168.9.52 80   
HTTP/1.1 200 OK
Date: Mon, 13 Oct 2025 12:03:52 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Connection: close
Content-Type: text/html
```

Für `curl` funktioniert das ganze ein wenig leichter, ganz ohne Header:
```sh
┌──(kali㉿kali)-[~]
└─$ curl -I 192.168.9.52                
HTTP/1.1 200 OK
Date: Mon, 13 Oct 2025 11:57:27 GMT
Server: Apache/2.2.8 (Ubuntu) DAV/2
X-Powered-By: PHP/5.2.4-2ubuntu5.10
Content-Type: text/html
```


#### Cheatsheet für Port Probing:

**Telnet**: Header nach Eingabe
```sh
$ telnet 192.168.9.52 80
GET / HTTP/1.0
```
**Netcat**: Header vor der Eingabe mit `printf`
```s
$ printf 'HEAD / HTTP/1.0\r\nHost: 192.168.9.52\r\n\r\n' | nc 192.168.9.52 80
```
**Curl**: Ohne Header, Option `-I`
```sh
$ curl -I 192.168.9.52
```

Für die Recherche wurde KI verwendet mir Prompts wie: `Testen des ssh Diensts über telnet`, `Wie findet man Bezeichnung und Version eines webservers raus über telnet`.

## Übung (netcat port scan)
Ermittle mit Hilfe von netcat welche Ports zwischen 1 und 30 in der Metasploitable VM geöffnet sind – Hinweis: dies geht in einer einzigen Kommandozeile. Recherchiere welche Dienste sich dort befinden.

Randnotitz: netcat wird auch gerne als das swiss army knife of network tools bezeichnet.

Mit der Option `-zv` und der Angabe `1-30`am Schluss bekommt man eine Übersicht der offenen Ports. `-z` ist für eine schnelle Ausgabe da, diese schließt die Ports nämlich direkt wieder nach dem öffnen und `-v` gibt eine detailierte Meldung in der Console aus.
```sh
┌──(kali㉿kali)-[~]
└─$ netcat -zv 192.168.9.52 1-30
192.168.9.52: inverse host lookup failed: Unknown host
(UNKNOWN) [192.168.9.52] 25 (smtp) open
(UNKNOWN) [192.168.9.52] 23 (telnet) open
(UNKNOWN) [192.168.9.52] 22 (ssh) open
(UNKNOWN) [192.168.9.52] 21 (ftp) open
```

## Übung (nmap port scan)
Nach dem ping scan (und wenn nicht die Option `-sn` angegeben ist) führt `nmap` automatisch einen port scan auf allen gefundenen hosts aus. Dabei wird versucht alle offenen Ports eines Hosts zu finden. Das Ziel ist eine Liste der am Host laufenden Dienste zu erhalten.

Hinweise: Man kann eine einzelne IP Adresse angeben, dann wird nur diese gescannt, z.B.: `nmap 192.168.178.42`

Siehe List of TCP and UDP port numbers

Aufgaben:

- Führe einen port scan auf die Metasploitable VM durch. Analysiere das Ergebnis.

- Experimentiere mit den Optionen für (Victim ist Metasploitable VM):
   -Scannen aller möglichen Ports. Macht das bei Metasploitable, verglichen zum Default Verhalten, einen Unterschied?
   -Überspringen Ping-Scan/Host-Discovery. Warum kann diese Option notwendig sein?
  - Service/Version Detection
  - OS Erkennung
  - Aggressive Scan
  - Timing/Speed
  - Ausgabe in Dateien
  - die Option --reason
  - nur die N häufigsten Ports scannen (dokumentiere den Geschwindigkeitsgewinn)
- Führe weitere port scans durch, auf:
  - einem Kali Linux auf einem anderen Rechner
  - einem Windows System
  - dem Default Gateway im Labor Netz
- Was kann alles mit einem port scan herausgefunden werden? Dokumentiere!

### Lösung

Die `nmap` Ausgabe gibt eine Liste einiger Ports aus die offen sind, nebendran mit einer Bezeichnung. Zusätzlich kann man noch rauslesen, dass 977 Ports gerschlossen sind. 
```sh
──(kali㉿kali)-[~]
└─$ nmap 192.168.9.52           
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-03 07:16 EST
Nmap scan report for 192.168.9.52
Host is up (0.0038s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:25:AA:6B (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.35 seconds
```

Mit der Option `-p` werden alle 65 535 Ports aufgedeckt statt den 1000 Default, jedoch wird dies von Kali blockiert, weil solches Verhalten nicht erlaubt ist.
```sh
┌──(kali㉿kali)-[~]
└─$ nmap -p 192.168.9.52   
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:02 EST
Error #487: Your port specifications are illegal.  Example of proper form: "-100,200-1024,T:3000-4000,U:60000-"
QUITTING!
```
Viele VM Netze blockiern ICMP, das kann dazu führen dass ein Host als offline gilt. Um das zu verhindern wird die Option `-Pn` verwendendet.
```sh
┌──(kali㉿kali)-[~]
└─$ nmap -Pn 192.168.9.52
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:09 EST
Nmap scan report for 192.168.9.52
Host is up (0.0075s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:25:AA:6B (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.34 seconds

```
Die Option `-sV` überprüft auch die Versionen der Dienste. Dadurch dauert der Scan auch länger.
```sh
┌──(kali㉿kali)-[~]
└─$ nmap -sV 192.168.9.52 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:13 EST
Nmap scan report for 192.168.9.52
Host is up (0.0036s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
53/tcp   open  domain      ISC BIND 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
111/tcp  open  rpcbind     2 (RPC #100000)
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
5900/tcp open  vnc         VNC (protocol 3.3)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
MAC Address: 00:0C:29:25:AA:6B (VMware)
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.70 seconds
    
```

Mit der Option `-O` wird am Ende des Scans noch das Betriebssystem ausgegeben.
```sh
┌──(kali㉿kali)-[~]
└─$ nmap -O 192.168.9.52
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:17 EST
Nmap scan report for 192.168.9.52
Host is up (0.0017s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:25:AA:6B (VMware)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop

OS detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1.61 seconds   
```

Um alles in einem Überblick zu haben wird die Option `-A` verwendent. Hier wird `-O`, `-sV`, Traceroute und NSE-Skripte kombiniert.
```sh
┌──(kali㉿kali)-[~]
└─$ nmap -A 192.168.9.52
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:23 EST
Nmap scan report for 192.168.9.52
Host is up (0.0015s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.9.51
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
|_ssl-date: 2025-11-17T11:24:20+00:00; +3s from scanner time.
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC2_128_CBC_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|_    SSL2_DES_192_EDE3_CBC_WITH_MD5
53/tcp   open  domain      ISC BIND 9.4.2
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-title: Metasploitable2 - Linux
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      49245/tcp   mountd
|   100005  1,2,3      51052/udp   mountd
|   100021  1,3,4      51449/udp   nlockmgr
|   100021  1,3,4      57894/tcp   nlockmgr
|   100024  1          34664/udp   status
|_  100024  1          43255/tcp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 9
|   Capabilities flags: 43564
|   Some Capabilities: SupportsCompression, LongColumnFlag, ConnectWithDatabase, SupportsTransactions, Speaks41ProtocolNew, SwitchToSSLAfterHandshake, Support41Auth
|   Status: Autocommit
|_  Salt: rnT7T!H&$"zflog9&P?,
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2025-11-17T11:24:20+00:00; +3s from scanner time.
5900/tcp open  vnc         VNC (protocol 3.3)
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
| irc-info: 
|   users: 1
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 0:26:06
|   source ident: nmap
|   source host: E33B0E13.2D206FBD.FFFA6D49.IP
|_  error: Closing Link: bjrbwdqip[192.168.9.51] (Quit: bjrbwdqip)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-title: Apache Tomcat/5.5
|_http-favicon: Apache Tomcat
|_http-server-header: Apache-Coyote/1.1
MAC Address: 00:0C:29:25:AA:6B (VMware)
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h15m02s, deviation: 2h30m00s, median: 2s
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-11-17T06:24:12-05:00
|_smb2-time: Protocol negotiation failed (SMB2)

TRACEROUTE
HOP RTT     ADDRESS
1   1.52 ms 192.168.9.52

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 21.33 seconds
```

Für Timing/Speed gibt es einige verschiedene Optionen.
| Option | Eigenschaft |
| ------ | ---------- |
| `-T0`, `-T1` |extrem langsam|
| `-T2`, `-T3` |Default|
| `-T4` |gut für VMs, schneller|
| `-T5` |extrem schnell, unzuverlässig|

```sh
┌──(kali㉿kali)-[~]
└─$ nmap -T3 192.168.9.52
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:39 EST
Nmap scan report for 192.168.9.52
Host is up (0.0028s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:25:AA:6B (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.30 seconds

┌──(kali㉿kali)-[~]
└─$ nmap -T4 192.168.9.52
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:40 EST
Nmap scan report for 192.168.9.52
Host is up (0.0025s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:25:AA:6B (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.27 seconds

┌──(kali㉿kali)-[~]
└─$ nmap -T5 192.168.9.52
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:40 EST
Nmap scan report for 192.168.9.52
Host is up (0.0070s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:0C:29:25:AA:6B (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.31 seconds
```

Um Dateien auszugeben gibt es folgende Optionen:
Tabelle für md:
| Option | Format    | Zweck                     |
| ------ | --------- | ------------------------- |
| `-oN`  | Normal    | lesbar         |
| `-oG`  | Grepable  | Für Skripte       |
| `-oX`  | XML       | Automatisierte Auswertung |
| `-oA`  | Alle drei | Beste Dokumentation       |


Tabelle für html:
<table>
  <tr>
    <th>Option</th>
    <th>Format</th>
    <th>Zweck</th>
  </tr>

  <tr>
    <td>-oN</td>
    <td>Normal</td>
    <td>lesbar</td>
  </tr>

  <tr>
    <td>-oG</td>
    <td>Grepable</td>
    <td>Für Skripte</td>
  </tr>

  <tr>
    <td>-oX</td>
    <td>XML</td>
    <td>Automatisierte Auswertung</td>
  </tr>

  <tr>
    <td>-oA</td>
    <td>Alle drei</td>
    <td>Beste Dokumentation</td>
  </tr>
</table>



Die Option `--reason` zeigt eine Begründung warum etwas als `open, closed, filtered` anzeigt.
```sh
┌──(kali㉿kali)-[~]
└─$ nmap --reason 192.168.9.52
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:41 EST
Nmap scan report for 192.168.9.52
Host is up, received arp-response (0.0065s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE      REASON
21/tcp   open  ftp          syn-ack ttl 64
22/tcp   open  ssh          syn-ack ttl 64
23/tcp   open  telnet       syn-ack ttl 64
25/tcp   open  smtp         syn-ack ttl 64
53/tcp   open  domain       syn-ack ttl 64
80/tcp   open  http         syn-ack ttl 64
111/tcp  open  rpcbind      syn-ack ttl 64
139/tcp  open  netbios-ssn  syn-ack ttl 64
445/tcp  open  microsoft-ds syn-ack ttl 64
512/tcp  open  exec         syn-ack ttl 64
513/tcp  open  login        syn-ack ttl 64
514/tcp  open  shell        syn-ack ttl 64
1099/tcp open  rmiregistry  syn-ack ttl 64
1524/tcp open  ingreslock   syn-ack ttl 64
2049/tcp open  nfs          syn-ack ttl 64
2121/tcp open  ccproxy-ftp  syn-ack ttl 64
3306/tcp open  mysql        syn-ack ttl 64
5432/tcp open  postgresql   syn-ack ttl 64
5900/tcp open  vnc          syn-ack ttl 64
6000/tcp open  X11          syn-ack ttl 64
6667/tcp open  irc          syn-ack ttl 64
8009/tcp open  ajp13        syn-ack ttl 64
8180/tcp open  unknown      syn-ack ttl 64
MAC Address: 00:0C:29:25:AA:6B (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.35 seconds
```

Mit `--top-ports <N>` werden nur die angegebene Anzahl an Ports gemessen, Geschwindigkeitsgewinn.
```sh
┌──(kali㉿kali)-[~]
└─$ nmap --top-ports 100 192.168.9.52 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:46 EST
Nmap scan report for 192.168.9.52
Host is up (0.00052s latency).
Not shown: 82 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
513/tcp  open  login
514/tcp  open  shell
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
8009/tcp open  ajp13
MAC Address: 00:0C:29:25:AA:6B (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.25 seconds
```

#### Andere Port Scans:

**Anderer Rechner(Kali)**
```sh
┌──(kali㉿kali)-[~]
└─$ nmap 192.168.10.51 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:47 EST
Nmap scan report for 192.168.10.51
Host is up (0.00086s latency).
All 1000 scanned ports on 192.168.10.51 are in ignored states.
Not shown: 599 filtered tcp ports (no-response), 401 closed tcp ports (reset)

Nmap done: 1 IP address (1 host up) scanned in 61.57 seconds
```

**Windows Rechner**
```sh
┌──(kali㉿kali)-[~]
└─$ nmap 192.168.9.50 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:51 EST
Nmap scan report for 192.168.9.50
Host is up (0.00027s latency).
All 1000 scanned ports on 192.168.9.50 are in ignored states.
Not shown: 1000 filtered tcp ports (no-response)
MAC Address: 60:A4:B7:75:7B:66 (TP-Link Limited)

Nmap done: 1 IP address (1 host up) scanned in 37.95 seconds

```

**Default Gateway**
```sh
┌──(kali㉿kali)-[~]
└─$ nmap 192.168.9.254
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:52 EST
Nmap scan report for 192.168.9.254
Host is up (0.0020s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE
23/tcp open  telnet
MAC Address: 1C:DF:0F:CA:41:01 (Cisco Systems)

Nmap done: 1 IP address (1 host up) scanned in 2.64 seconds
```

#### Cheat Sheet für Nmap:
Nur für md:
| Option | Beschreibung | Eigenschaft |
|---------/--------/----------------------------/
| -p- | vollständiger Portscan | wenige zusätzliche Ports, viel langsamer |
| -Pn | überspringt Host Discovery | oft notwendig in VM-Netzen |
| -sV | Dienst- und Versionsinfos | sehr informativ auf Metasploitable |
| -O | OS-Erkennung | zuverlässig im offenen VM-Netz |
| -A | Alles kombiniert | sehr gute Übersicht, langsam |
| -T4 | schnelles Timing | ideal für lokale VM-Scans |
| --reason | zeigt Entscheidungsgrundlage | gut für Dokumentation |
| --top-ports N | schnellster Scan | großer Geschwindigkeitsgewinn |

Tabelle für html:
<table>
  <tr>
    <th>Option</th>
    <th>Beschreibung</th>
    <th>Eigenschaft</th>
  </tr>

  <tr>
    <td>-p-</td>
    <td>vollständiger Portscan</td>
    <td>wenige zusätzliche Ports, viel langsamer</td>
  </tr>

  <tr>
    <td>-Pn</td>
    <td>überspringt Host Discovery</td>
    <td>oft notwendig in VM-Netzen</td>
  </tr>

  <tr>
    <td>-sV</td>
    <td>Dienst- und Versionsinfos</td>
    <td>sehr informativ auf Metasploitable</td>
  </tr>

  <tr>
    <td>-O</td>
    <td>OS-Erkennung</td>
    <td>zuverlässig im offenen VM-Netz</td>
  </tr>

  <tr>
    <td>-A</td>
    <td>kombiniert OS-, Versionsscan und Skripte</td>
    <td>sehr gute Übersicht, langsam</td>
  </tr>

  <tr>
    <td>-T4</td>
    <td>schnelles Timing</td>
    <td>ideal für lokale VM-Scans</td>
  </tr>

  <tr>
    <td>--reason</td>
    <td>zeigt Entscheidungsgrundlage der Portbewertung</td>
    <td>gut für Dokumentation</td>
  </tr>

  <tr>
    <td>--top-ports N</td>
    <td>scannt nur die N häufigsten Ports</td>
    <td>sehr großer Geschwindigkeitsgewinn</td>
  </tr>
</table>


Durch einen Port Scan können viele Informationen herausgefunden werden. Unter anderem die geschlossenen, offenen und gefilterten Ports, welche Dienste laufen, die Versionen der Dienste, Betriebssystem des Hosts, und so weier...
